# Campaign Models Relationship Diagram

```mermaid
flowchart TD
    subgraph Input["Input Entities"]
        EIn1[Entity - Campaign Input]
        EIn2[Entity - ItemConfig Input]
    end

    subgraph Campaign_Layer["Campaign Layer"]
        C[Campaign]
        IC[ItemConfig]
    end

    subgraph Activities
        CG[ConfigGeneration]
        CE[ConfigExecution]
    end

    subgraph Output["Output Entities"]
        EOut[Entity - Output]
    end

    EIn1 -->|EntityToCampaign| C
    EIn2 -->|EntityToItemConfig| IC
    C -->|campaign_id FK| IC

    C -->|Usage| CG
    CG -->|Generation| IC

    IC -->|Usage| CE
    CE -->|Generation| EOut

    style C fill:#e1f5ff
    style IC fill:#e1f5ff
    style EIn1 fill:#d4edda
    style EIn2 fill:#d4edda
    style EOut fill:#f8d7da
    style CG fill:#fff4e1
    style CE fill:#fff4e1
```

## ER Diagram

```mermaid
erDiagram
    Entity_Campaign_Input ||--o{ EntityToCampaign : "input"
    Campaign ||--o{ EntityToCampaign : "has"
    Campaign ||--o{ ItemConfig : "campaign_id"

    Entity_ItemConfig_Input ||--o{ EntityToItemConfig : "input"
    ItemConfig ||--o{ EntityToItemConfig : "has"

    Campaign ||--o{ Usage_CG : "used by ConfigGeneration"
    Usage_CG }o--|| ConfigGeneration : ""
    ConfigGeneration ||--o{ Generation_CG : ""
    Generation_CG }o--|| ItemConfig : "generated by ConfigGeneration"

    ItemConfig ||--o{ Usage_CE : "used by ConfigExecution"
    Usage_CE }o--|| ConfigExecution : ""
    ConfigExecution ||--o{ Generation_CE : ""
    Generation_CE }o--|| Entity_Output : "generated by ConfigExecution"

    Entity {
        uuid id PK
    }

    EntityToCampaign {
        uuid entity_id PK,FK
        uuid campaign_id PK,FK
    }

    EntityToItemConfig {
        uuid entity_id PK,FK
        uuid item_config_id PK,FK
    }

    Campaign {
        uuid id PK,FK
        JSON_DICT scan_parameters
        TaskType task_type
    }

    Usage {
        uuid usage_entity_id PK,FK
        uuid usage_activity_id PK,FK
    }

    Generation {
        uuid generation_entity_id PK,FK
        uuid generation_activity_id PK,FK
    }

    ItemConfig {
        uuid id PK,FK
        JSON_DICT scan_parameters
        TaskType task_type
        uuid campaign_id FK
    }

    ConfigGeneration {
        uuid id PK,FK
    }

    ConfigExecution {
        uuid id PK,FK
    }
```

## Relationships Explained

### Flowchart (Primary)
Shows the workflow clearly:
- **Green boxes**: Input entities
  - Campaign inputs (linked via EntityToCampaign)
  - ItemConfig inputs (linked via EntityToItemConfig)
- **Blue boxes**: Campaign entities (Campaign and ItemConfig)
- **Yellow boxes**: Activities (processes)
- **Red box**: Output entities (generated by ConfigExecution)
- Input and output entities are different instances, though all are Entity type

### ER Diagram (Detailed)
Shows the same relationships with Usage and Generation tables split by activity:
- **EntityToCampaign**: Junction table linking input entities to Campaign
- **EntityToItemConfig**: Junction table linking input entities to ItemConfig
- **Usage_CG**: Usage records for ConfigGeneration activity
- **Generation_CG**: Generation records for ConfigGeneration activity
- **Usage_CE**: Usage records for ConfigExecution activity
- **Generation_CE**: Generation records for ConfigExecution activity

Notes:
- Campaign has many input entities (via EntityToCampaign)
- ItemConfig has many input entities (via EntityToItemConfig)
- One Campaign is used by ConfigGeneration to generate many ItemConfig
- One ItemConfig can be used by many ConfigExecution, each generating many Entity
- Activities (ConfigGeneration, ConfigExecution) do not have task_type field, but it can be added if useful
