# Campaign Models Relationship Diagram

```mermaid
flowchart TD
    subgraph Input["Input Entities"]
        EIn1[Entity - Campaign Input]
        EIn2[Entity - TaskConfig Input]
    end

    subgraph Campaign_Layer["Campaign Layer"]
        C[Campaign]
        TC[TaskConfig]
    end

    subgraph Activities
        CG[ConfigGeneration]
        TE[TaskExecution]
    end

    subgraph Output["Output Entities"]
        EOut[Entity - Output]
    end

    EIn1 -->|EntityToCampaign| C
    EIn2 -->|EntityToTaskConfig| TC
    C -->|campaign_id FK| TC

    C -->|Usage| CG
    CG -->|Generation| TC

    TC -->|Usage| TE
    TE -->|Generation| EOut

    style C fill:#e1f5ff
    style TC fill:#e1f5ff
    style EIn1 fill:#d4edda
    style EIn2 fill:#d4edda
    style EOut fill:#f8d7da
    style CG fill:#fff4e1
    style TE fill:#fff4e1
```

## ER Diagram

```mermaid
erDiagram
    Entity_Campaign_Input ||--o{ EntityToCampaign : "input"
    Campaign ||--o{ EntityToCampaign : "has"
    Campaign ||--o{ TaskConfig : "campaign_id"

    Entity_TaskConfig_Input ||--o{ EntityToTaskConfig : "input"
    TaskConfig ||--o{ EntityToTaskConfig : "has"

    Campaign ||--o{ Usage_CG : "used by ConfigGeneration"
    Usage_CG }o--|| ConfigGeneration : ""
    ConfigGeneration ||--o{ Generation_CG : ""
    Generation_CG }o--|| TaskConfig : "generated by ConfigGeneration"

    TaskConfig ||--o{ Usage_TE : "used by TaskExecution"
    Usage_TE }o--|| TaskExecution : ""
    TaskExecution ||--o{ Generation_TE : ""
    Generation_TE }o--|| Entity_Output : "generated by TaskExecution"

    Entity {
        uuid id PK
    }

    EntityToCampaign {
        uuid entity_id PK,FK
        uuid campaign_id PK,FK
    }

    EntityToTaskConfig {
        uuid entity_id PK,FK
        uuid task_config_id PK,FK
    }

    Campaign {
        uuid id PK,FK
        JSON_DICT scan_parameters
        TaskType task_type
    }

    Usage {
        uuid usage_entity_id PK,FK
        uuid usage_activity_id PK,FK
    }

    Generation {
        uuid generation_entity_id PK,FK
        uuid generation_activity_id PK,FK
    }

    TaskConfig {
        uuid id PK,FK
        JSON_DICT scan_parameters
        TaskType task_type
        uuid campaign_id FK
    }

    ConfigGeneration {
        uuid id PK,FK
    }

    TaskExecution {
        uuid id PK,FK
    }
```

## Relationships Explained

### Flowchart (Primary)
Shows the workflow clearly:
- **Green boxes**: Input entities
  - Campaign inputs (linked via EntityToCampaign)
  - TaskConfig inputs (linked via EntityToTaskConfig)
- **Blue boxes**: Campaign entities (Campaign and TaskConfig)
- **Yellow boxes**: Activities (processes)
- **Red box**: Output entities (generated by TaskExecution)
- Input and output entities are different instances, though all are Entity type

### ER Diagram (Detailed)
Shows the same relationships with Usage and Generation tables split by activity:
- **EntityToCampaign**: Junction table linking input entities to Campaign
- **EntityToTaskConfig**: Junction table linking input entities to TaskConfig
- **Usage_CG**: Usage records for ConfigGeneration activity
- **Generation_CG**: Generation records for ConfigGeneration activity
- **Usage_TE**: Usage records for TaskExecution activity
- **Generation_TE**: Generation records for TaskExecution activity

Notes:
- Campaign has many input entities (via EntityToCampaign)
- TaskConfig has many input entities (via EntityToTaskConfig)
- One Campaign is used by ConfigGeneration to generate many TaskConfig
- One TaskConfig can be used by many TaskExecution, each generating many Entity
- Activities (ConfigGeneration, TaskExecution) do not have task_type field
